# README for Google Sheets Automation Script

## Overview

This script automates the process of creating Google Sheets, running accessibility scans on specified URLs using the Purple A11y CLI tool, analyzing the CSV reports generated by the scans, and then uploading both the detailed scan results and summaries to Google Sheets. It's designed to help organizations monitor and improve their web accessibility compliance over time.

## Features

- **Google Sheets Creation & Update:** Automatically creates new Google Sheets for storing scan results and summaries. If a sheet for the current day already exists, the script updates it with new data.
- **Accessibility Scanning:** Utilizes the Purple A11y CLI tool to perform web accessibility scans on a list of URLs provided in a configuration file.
- **Data Analysis:** Analyzes the CSV files generated by Purple A11y to summarize the findings, such as the count of unique issues, severity levels, and WCAG compliance.
- **Automated Uploads:** Uploads both the detailed scan results and the generated summaries to the corresponding Google Sheets.

## Prerequisites

Before running the script, ensure you have the following:

- Node.js installed on your machine.
- A Google Cloud project with the Google Sheets API enabled.
- Downloaded credentials (in JSON format) for OAuth2 authentication from the Google Cloud Console.
- The Purple A11y CLI tool installed and accessible from your system's PATH.

## Configuration

1. **Google Cloud Credentials:** Place your `credentials.json` file in the root directory of the script. This file is obtained from your Google Cloud project's API & Services Credentials page.

2. **Token Storage:** The first time you run the script, you'll need to authorize access to your Google Sheets. The script will save a `token.json` file in the root directory for subsequent executions.

3. **URLs and Sheet Names:** Configure the `google-crawl.yml` file with the URLs you wish to scan and the desired names for the Google Sheets. Here's a sample configuration:

   ```yaml
   mywebsite:
     - url: https://www.example.com
       name: ExampleSiteAccessibility
   ```

## Running the Script

1. **Start the Script:** Run the script using Node.js. Navigate to the directory containing the script and run:

   ```
   node your-script-name.js
   ```

2. **Authorize Access:** If it's your first time running the script, you'll be prompted to visit a URL to authorize access to your Google Sheets. Follow the instructions in the terminal.

3. **Review Results:** After the script completes, you'll find the detailed scan results and summaries in the Google Sheets created or updated by the script. The sheets will be named according to the current date and the names specified in your configuration file.

## Expected Results

- New Google Sheets will be created for each site listed in your `google-crawl.yml` file, or existing sheets for the current day will be updated.
- Each sheet will contain detailed accessibility scan results and a summary of findings, including counts of unique issues, severity levels, and WCAG compliance indicators.
- The script logs its progress in the terminal, indicating the completion of scans, analysis, and uploads.

## Troubleshooting

- **Authentication Issues:** If you encounter authentication errors, ensure your `credentials.json` file is correct and that you've followed the authorization steps accurately.
- **Purple A11y CLI Not Found:** Ensure the Purple A11y CLI tool is installed and correctly set up in your system's PATH.
- **Script Errors:** Check the terminal output for error messages that can help diagnose issues with the script execution or with the Google Sheets API.

For further assistance or to report bugs, please consult the documentation for the Google Sheets API, Purple A11y CLI tool, or contact the script developer.
